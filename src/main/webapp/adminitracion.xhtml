<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml"

       xmlns:h="http://xmlns.jcp.org/jsf/html"

       xmlns:f="http://java.sun.com/jsf/core"

       xmlns:p="http://primefaces.org/ui"
       xmlns:ui="http://java.sun.com/jsf/facelets"
       xmlns:c="http://java.sun.com/jsp/jstl/core">

    <h:head>
        <title>Template</title>
        <h:outputStylesheet name="css/publico.css" />
        <h:outputStylesheet name="dataTable/css/dataTables.bootstrap.min.css" />	
        <h:outputStylesheet name="dataTable/css/jquery.dataTables.min.css" />


        <style>
            body{
                font-family: "PT Sans",Arial,Helvetica,sans-serif;
            }
            .bg-light{
                background-color: #8b0000!important;
            }


            .value {
                font-weight: bold;
            }


            .boton{
                border-radius: 11px;

                background-color: rgba(144, 22, 38, 0.7);

                border: rgba(144, 22, 38, 0.7);

                text-align:center;

                color : rgba(255, 255, 255, 1)
            }

        </style>

    </h:head>




    <h:body style="background-image:url(resources/images/fondoUsu.jpg);background-size:cover;background-repeat: no-repeat;" >
        <f:metadata>
            <f:viewParam name="correo" value="#{usuarioBean.correo}" />
        </f:metadata>


        <!-- creacion de la barra-->

        <p:inputText id="nom" binding="#{nom}" value = "#{usuarioBean.getUsuario().getNombre()}" style="display:none"/>
        <p:inputText id="nomi" binding="#{nomi}" value = "#{usuarioBean.getUsuario().getTipo()}" style="display:none"/>
        <nav class="navbar navbar-default" style="height:8px">
            <div class="container-fluid">
                <!-- Collect the nav links, forms, and other content for toggling -->
                <div class="collapse navbar-collapse"
                     id="bs-example-navbar-collapse-1">
                    <ul class="nav navbar-nav">
                        <h:panelGrid columns="1"
                                     style="
                                     text-align:center;
                                     margin: 1% auto;
                                     height:5px;">
                            <h:outputText value="#{nom.value}"
                                          style=" font-size: 20px;
                                          color : rgba(255, 255, 255, 1);
                                          " />

                            <h:outputText value="#{nomi.value}"
                                          style=" font-size: 15px;
                                          color : rgba(255, 255, 255, 1);
                                          " />
                        </h:panelGrid>
                    </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li><a href="index.xhtml" style="font-size: 1.5rem"><span
                                    class="glyphicon glyphicon-log-in"></span> Salir</a></li>
                    </ul>
                </div>
            </div>
        </nav>

        <!--creracion tablas-->

        <div class="col-xs-6" style="background-color:transparent;">
            <table id="TablaUsr" class="table table-striped table-bordered"  style="width:100%; background-color: white">
                <thead>
                    <tr>
                        <th>Nombre</th>
                        <th>Correo</th>                        
                        <th>Area</th>    
                        <th>Rol</th>
                        <th>Cambio</th>
                    </tr>
                </thead>
                <tbody>

                    <ui:repeat value ="#{usuarioBean.usr()}" var="usr">
                        <tr id="#{usr.correo}">
                            <td>#{usr.nombre}</td>
                            <td>#{usr.correo}</td>                            
                            <td>#{usr.area.nombre}</td>
                            <td  >#{usr.tipo}</td>
                            <td  style="text-align:center;">
                                <h:panelGroup layout="block">
                                    <button class="modify-usu btn btn-success" data-id="#{usr.correo}" data-toggle="modal" data-target="#myModalUser">Modificar</button></h:panelGroup>
                            </td>
                        </tr>
                    </ui:repeat>


                </tbody>
            </table>
            <div class="modal fade" id="myModalUser" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content"></div>
                </div>
                <div class="modal-dialog">
                    <div class="modal-content"></div>
                </div>
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal"> <span aria-hidden="true" class=""></span><span class="sr-only">Close</span>

                            </button>
                            <h4 class="modal-title" id="myModalLabel">Cambiar Rol</h4>

                        </div>
                        <div class="modal-body">
                            <h:form id="usuario_form">
                                <input type="text" name="emailUser" id="emailUser" value="" style="visibility: hidden" />	  
                                <p:inputText id="emailUser" binding="#{emailUser}" type= "hidden" />
                                <div class="form-group" >
                                    <label for="NuevoRol">Cambiar Rol</label>
                                    <select class="form-control" id="selectUsr">
                                        <label for="NuevoRol">Nuevo Rol</label>
                                        <ui:repeat var="item" value="#{usuarioBean.getTypes()}">
                                            <option value="#{item.ordinal()}">#{item}</option>
                                        </ui:repeat> 
                                    </select>
                                    <p:inputText styleClass="rol" binding="#{modifyRolUser}" type="hidden"  />
                                </div>
                                <div class="modal-body"></div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-default" data-dismiss="modal" >Cancelar</button>
                                    <p:commandButton value = "Modificar"
                                                     actionListener="#{usuarioBean.changeRol(emailUser.value,modifyRolUser.value)}" id="boton" styleClass="btn btn-success">
                                    </p:commandButton>

                                </div>
                            </h:form>
                        </div>

                    </div>
                </div>
            </div>
        </div>
        <div class="col-xs-6" style="background-color:transparent;">
            <table id="TablaIni" class="table table-striped table-bordered"  style="width:100%; background-color: white">
                <thead>
                    <tr>
                        <th>Nombre</th>
                        <th>Proponente</th>
                        <th>Estado</th>    
                        <th>fechas</th>
                        <th>Descripcion</th>
                       
                        <th>Votos</th>
                         <th class="">Cambio</th>
                         <th>Votar</th>
                        
                    </tr>

                </thead>
                <tbody>

                    <ui:repeat value ="#{iniciativaBean.inivs()}" var="ini">
                        <tr id="#{ini.nombre}">
                            <td>#{ini.nombre}</td>
                            <td>#{ini.proponente.nombre}</td>
                            <td  >#{ini.estado}</td>
                            <td>#{ini.fechaPropuesta}</td>      
                            <td>#{ini.descripcion}</td>
                            <td>#{iniciativaBean.votos(ini.nombre)}</td>
                            <td  style="text-align:center;">
                                <h:panelGroup layout="block">
                                    <button class="modify-ini btn btn-success" data-id="#{ini.nombre}" data-toggle="modal" data-target="#myModal">Modificar</button>
                                </h:panelGroup>
                            </td>
                                 <td  style="text-align:center;">
                                <h:panelGroup layout="block">
                                    <button class="votos btn btn-success" data-id="#{ini.nombre}" data-toggle="modal" data-target="#ModalVoto">Voto</button>
                                </h:panelGroup>
                            </td>
                        </tr>
                    </ui:repeat>


                </tbody>
            </table>
              <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content"></div>
                </div>
                <div class="modal-dialog">
                    <div class="modal-content"></div>
                </div>
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal"> <span aria-hidden="true" class=""></span><span class="sr-only">Close</span>

                            </button>
                            <h4 class="modal-title" id="myModalLabel">Cambiar Estado</h4>

                        </div>
                        <div class="modal-body">
                            <h:form id="est_form">
                                
                                <input type="text" name="nameIni" id="nameIni" value=""  style="visibility: hidden"/>	  
                                <p:inputText id="nameIni" binding="#{nameIni}" type="hidden" />
                                <div class="form-group" >
                                    <label for="NuevoEst">Nuevo Estado</label>
                                    <select class="form-control" id="select">
                                        <label for="NuevoEst">Nuevo Estado</label>
                                        <ui:repeat var="item" value="#{iniciativaBean.getTypes()}">
                                            <option value="#{item.ordinal()}">#{item}</option>
                                        </ui:repeat> 
                                    </select>
                                    <p:inputText styleClass="rol" binding="#{modifyEst}" type="hidden"  />
                                </div>
                                <div class="modal-body"></div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                                    <p:commandButton value = "Modificar"
                                                     actionListener="#{iniciativaBean.cambioEstado(nameIni.value,modifyEst.value)}" id="boton" styleClass="btn btn-success">
                                    </p:commandButton>

                                </div>
                            </h:form>
                        </div>

                    </div>
                </div>
            </div>
        </div>

            
            <div class="modal fade" id="ModalVoto" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content"></div>
                </div>
                <div class="modal-dialog">
                    <div class="modal-content"></div>
                </div>
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal"> <span aria-hidden="true" class=""></span><span class="sr-only">Close</span>

                            </button>
                            <h4 class="modal-title" id="myModalLabel">Votar:</h4>

                        </div>
                        <div class="modal-body">
                            <h:form id="votos_form">
                                
                                <input type="text" name="lik" id="lik" value="" style="visibility: hidden" />	  
                                <p:inputText id="lik" binding="#{lik}" type="hidden" />
                                <div class="form-group" >
                                    <label for="votar">Vota:</label>
                                    <h:panelGroup style="position: center">
                                    <p:commandButton value = "Like"  actionListener="#{iniciativaBean.votar(usuarioBean.correo,lik.value)}"
                                                      id="like" styleClass="btn btn-success" >
                                    </p:commandButton>
                                    <p:commandButton value = "dislike" actionListener="#{iniciativaBean.dislike(usuarioBean.correo,lik.value)}"
                                                      id="dislike" styleClass="btn btn-success">
                                    </p:commandButton>
                                    </h:panelGroup>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                                </div>
                            </h:form>
                        </div>

                    </div>
                </div>
            </div>
       

        <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>

        <h:outputStylesheet name="bootstrap-3.3.7-dist/css/bootstrap.min.css" />
        <h:outputScript name="dataTable/js/jquery.dataTables.min.js" />
        <h:outputScript name="dataTable/js/dataTables.bootstrap.min.js" />
        <h:outputScript name="js/usr.js"></h:outputScript>
<h:outputScript name="js/gh.js"></h:outputScript>
        <h:outputScript name="js/ini.js"></h:outputScript>
    </h:body>
</html>